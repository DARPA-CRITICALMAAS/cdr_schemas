


# CDR Schemas


## Development

Formatting Code
```
poetry run format
```


Verify Changes
```
# verify types (mypy)
poetry run types

# lint
poetry run lint
```

Build local package

```
poetry build -f sdist
```


Update Schema Diagrams

To generate schemas you will need to run `poetry install --with docs` to install the proper dependencies

```
poetry run docs
```

<!--#+BEGIN_SCHEMA-->
<!-- this sections is autogenerated -->

## Schemas


### Georeference

<details open>
    <summary>georeference</summary>

```mermaid
classDiagram

    class Pixel_Point {
        rows_from_top: Union[float, int]
        columns_from_left: Union[float, int]
        type: GeomType = GeomType.Point
    }

    class GeomType {
        <<Enumeration>>
        Point: str = 'Point'
        LineString: str = 'LineString'
        Polygon: str = 'Polygon'
    }

    class Area_Extraction {
        type: GeomType = GeomType.Polygon
        coordinates: list[list[list[Union[float, int]]]]
        bbox: Optional[list[Union[float, int]]]
        category: AreaType
        text: Optional[str]
        confidence: Optional[float]
        model: Optional[str]
        model_version: Optional[str]
    }

    class GeoreferenceResult {
        likely_CRSs: Optional[list[str]]
        map_area: Optional[Area_Extraction]
        projections: Optional[list[ProjectionResult]]
    }

    class ProjectionResult {
        id: str
        crs: str
        gcp_ids: list[str]
        file_name: str
    }

    class GeoreferenceResults {
        cog_id: str
        georeference_results: Optional[list[GeoreferenceResult]]
        gcps: Optional[list[GroundControlPoint]]
        system: str
        system_version: str
    }

    class GroundControlPoint {
        gcp_id: str
        map_geom: Geom_Point
        px_geom: Pixel_Point
        confidence: Optional[float]
        model: str
        model_version: str
        crs: Optional[str]
    }

    class Geom_Point {
        latitude: Union[float, int, NoneType]
        longitude: Union[float, int, NoneType]
        type: GeomType = GeomType.Point
    }

    Area_Extraction ..> GeomType
    Area_Extraction ..> AreaType
    Geom_Point ..> GeomType
    Pixel_Point ..> GeomType
    GroundControlPoint ..> Pixel_Point
    GroundControlPoint ..> Geom_Point
    GeoreferenceResult ..> Area_Extraction
    GeoreferenceResult ..> ProjectionResult
    GeoreferenceResults ..> GeoreferenceResult
    GeoreferenceResults ..> GroundControlPoint


```

</details>

### Metadata

<details open>
    <summary>metadata</summary>

```mermaid
classDiagram

    class MapMetaData {
        title: Optional[str]
        year: Optional[int]
        crs: Optional[str]
        authors: Optional[list[str]]
        organization: Optional[str]
        scale: Optional[int]
        quadrangle_name: Optional[str]
        map_shape: Optional[MapShapeTypes]
        map_color_scheme: Optional[MapColorSchemeTypes]
        publisher: Optional[str]
        state: Optional[str]
        model: str
        model_version: str
    }

    class CogMetaData {
        cog_id: str
        system: str
        system_version: str
        multiple_maps: Optional[bool]
        map_metadata: Optional[list[MapMetaData]]
    }

    class MapShapeTypes {
        <<Enumeration>>
        rectangular: str = 'rectangular'
        non_rectangular: str = 'non_rectangular'
    }

    class MapColorSchemeTypes {
        <<Enumeration>>
        full_color: str = 'full_color'
        monochrome: str = 'monochrome'
        grayscale: str = 'grayscale'
    }

    MapMetaData ..> MapShapeTypes
    MapMetaData ..> MapColorSchemeTypes
    CogMetaData ..> MapMetaData


```

</details>

### Feature Results

<details open>
    <summary>feature results</summary>

```mermaid
classDiagram

    class FeatureResults {
        cog_id: str
        line_feature_results: Optional[list[LineLegendAndFeaturesResult]]
        point_feature_results: Optional[list[PointLegendAndFeaturesResult]]
        polygon_feature_results: Optional[list[PolygonLegendAndFeauturesResult]]
        map_area_extractions: Optional[list[Area_Extraction]]
        system: str
        system_version: str
    }

    class PolygonLegendAndFeauturesResult {
        id: str
        crs: str
        cdr_projection_id: Optional[str]
        map_unit: Optional[MapUnit]
        abbreviation: Optional[str]
        legend_bbox: Optional[list[Union[float, int]]]
        category: Optional[str]
        color: Optional[str]
        description: Optional[str]
        pattern: Optional[str]
        polygon_features: Optional[PolygonFeatureCollection]
    }

    class Area_Extraction {
        type: GeomType = GeomType.Polygon
        coordinates: list[list[list[Union[float, int]]]]
        bbox: Optional[list[Union[float, int]]]
        category: AreaType
        text: Optional[str]
        confidence: Optional[float]
        model: Optional[str]
        model_version: Optional[str]
    }

    class PointLegendAndFeaturesResult {
        id: str
        crs: str
        cdr_projection_id: Optional[str]
        name: Optional[str]
        description: Optional[str]
        legend_bbox: Optional[list[Union[float, int]]]
        point_features: Optional[list[PointFeatureCollection]]
    }

    class LineLegendAndFeaturesResult {
        id: str
        crs: str
        cdr_projection_id: Optional[str]
        name: Optional[str]
        description: Optional[str]
        legend_bbox: Optional[list[Union[float, int]]]
        line_features: Optional[LineFeatureCollection]
    }

    Area_Extraction ..> GeomType
    Area_Extraction ..> AreaType
    LineLegendAndFeaturesResult ..> LineFeatureCollection
    PointLegendAndFeaturesResult ..> PointFeatureCollection
    PolygonLegendAndFeauturesResult ..> MapUnit
    PolygonLegendAndFeauturesResult ..> PolygonFeatureCollection
    FeatureResults ..> Area_Extraction
    FeatureResults ..> PointLegendAndFeaturesResult
    FeatureResults ..> LineLegendAndFeaturesResult
    FeatureResults ..> PolygonLegendAndFeauturesResult


```

</details>

### Point Feature

<details open>
    <summary>point feature</summary>

```mermaid
classDiagram

    class PointFeatureCollection {
        type: GeoJsonType = GeoJsonType.FeatureCollection
        features: list[PointFeature]
    }

    class Point {
        coordinates: list[Union[float, int]]
        type: GeomType = GeomType.Point
    }

    class GeomType {
        <<Enumeration>>
        Point: str = 'Point'
        LineString: str = 'LineString'
        Polygon: str = 'Polygon'
    }

    class GeoJsonType {
        <<Enumeration>>
        Feature: str = 'Feature'
        FeatureCollection: str = 'FeatureCollection'
    }

    class PointProperties {
        model: Optional[str]
        model_version: Optional[str]
        confidence: Optional[float]
        bbox: Optional[list[Union[float, int]]]
        dip: Optional[int]
        dip_direction: Optional[int]
    }

    class PointFeature {
        type: GeoJsonType = GeoJsonType.Feature
        id: str
        geometry: Point
        properties: PointProperties
    }

    class PointLegendAndFeaturesResult {
        id: str
        crs: str
        cdr_projection_id: Optional[str]
        name: Optional[str]
        description: Optional[str]
        legend_bbox: Optional[list[Union[float, int]]]
        point_features: Optional[list[PointFeatureCollection]]
    }

    Point ..> GeomType
    PointFeature ..> PointProperties
    PointFeature ..> Point
    PointFeature ..> GeoJsonType
    PointFeatureCollection ..> GeoJsonType
    PointFeatureCollection ..> PointFeature
    PointLegendAndFeaturesResult ..> PointFeatureCollection


```

</details>

### Line Feature

<details open>
    <summary>line feature</summary>

```mermaid
classDiagram

    class Line {
        coordinates: list[list[Union[float, int]]]
        type: GeomType = GeomType.LineString
    }

    class GeomType {
        <<Enumeration>>
        Point: str = 'Point'
        LineString: str = 'LineString'
        Polygon: str = 'Polygon'
    }

    class GeoJsonType {
        <<Enumeration>>
        Feature: str = 'Feature'
        FeatureCollection: str = 'FeatureCollection'
    }

    class LineProperty {
        model: Optional[str]
        model_version: Optional[str]
        confidence: Optional[float]
        dash_pattern: Optional[DashType] = None
        symbol: Optional[str]
    }

    class LineLegendAndFeaturesResult {
        id: str
        crs: str
        cdr_projection_id: Optional[str]
        name: Optional[str]
        description: Optional[str]
        legend_bbox: Optional[list[Union[float, int]]]
        line_features: Optional[LineFeatureCollection]
    }

    class LineFeatureCollection {
        type: GeoJsonType = GeoJsonType.FeatureCollection
        features: Optional[list[LineFeature]]
    }

    class LineFeature {
        type: GeoJsonType = GeoJsonType.Feature
        id: str
        geometry: Line
        properties: LineProperty
    }

    class DashType {
        <<Enumeration>>
        solid: str = 'solid'
        dash: str = 'dash'
        dotted: str = 'dotted'
    }

    Line ..> GeomType
    LineProperty ..> DashType
    LineFeature ..> Line
    LineFeature ..> GeoJsonType
    LineFeature ..> LineProperty
    LineFeatureCollection ..> LineFeature
    LineFeatureCollection ..> GeoJsonType
    LineLegendAndFeaturesResult ..> LineFeatureCollection


```

</details>

### Polygon Feature

<details open>
    <summary>polygon feature</summary>

```mermaid
classDiagram

    class MapUnit {
        age_text: Optional[str]
        b_age: Optional[float]
        b_interval: Optional[str]
        lithology: Optional[str]
        name: Optional[str]
        t_age: Optional[float]
        t_interval: Optional[str]
        comments: Optional[str]
    }

    class GeomType {
        <<Enumeration>>
        Point: str = 'Point'
        LineString: str = 'LineString'
        Polygon: str = 'Polygon'
    }

    class GeoJsonType {
        <<Enumeration>>
        Feature: str = 'Feature'
        FeatureCollection: str = 'FeatureCollection'
    }

    class Polygon {
        coordinates: list[list[list[Union[float, int]]]]
        type: GeomType = GeomType.Polygon
    }

    class PolygonProperty {
        model: Optional[str]
        model_version: Optional[str]
        confidence: Optional[float]
    }

    class PolygonFeature {
        type: GeoJsonType = GeoJsonType.Feature
        id: str
        geometry: Polygon
        properties: PolygonProperty
    }

    class PolygonLegendAndFeauturesResult {
        id: str
        crs: str
        cdr_projection_id: Optional[str]
        map_unit: Optional[MapUnit]
        abbreviation: Optional[str]
        legend_bbox: Optional[list[Union[float, int]]]
        category: Optional[str]
        color: Optional[str]
        description: Optional[str]
        pattern: Optional[str]
        polygon_features: Optional[PolygonFeatureCollection]
    }

    class PolygonFeatureCollection {
        type: GeoJsonType = GeoJsonType.FeatureCollection
        features: Optional[list[PolygonFeature]]
    }

    Polygon ..> GeomType
    PolygonFeature ..> PolygonProperty
    PolygonFeature ..> GeoJsonType
    PolygonFeature ..> Polygon
    PolygonFeatureCollection ..> PolygonFeature
    PolygonFeatureCollection ..> GeoJsonType
    PolygonLegendAndFeauturesResult ..> MapUnit
    PolygonLegendAndFeauturesResult ..> PolygonFeatureCollection


```

</details>
<!--#+END_SCHEMA-->
